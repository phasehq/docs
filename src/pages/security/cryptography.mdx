export const description = 'Phase cryptography'

# Cryptogrpahy

## Encryption - XChaCha20-Poly1305

ChaCha20-Poly1305 is an authenticated encryption with additional data (AEAD) algorithm, that combines the ChaCha20 stream cipher with the Poly1305 message authentication code. Its usage in IETF protocols is standardized in RFC 8439.

![ChaCha20-Poly1305](/assets/ChaCha20-Poly1305_Encryption.png)

- XChaCha20: This is a variant of the ChaCha20 stream cipher, but it has a longer nonce size. The original ChaCha20 uses a 64-bit nonce, which is a number that should only be used once per key. However, managing nonces can be difficult in practice and reusing a nonce can lead to serious vulnerabilities. XChaCha20 increases the nonce size to 192 bits, significantly reducing the risk of nonce reuse.
- Poly1305: This is a message authentication code (MAC) that is used to ensure the integrity and authenticity of a message. It's secure and efficient, helping to ensure that an encrypted message hasn't been tampered with.

Fun fact: ChaCha20-Poly1305 is currently being used in TLS 1.3, Wireguard and others!

## Key agreement - X25519

The X25519 key exchange algorithm is based on the elliptic curve Diffie-Hellman (ECDH) protocol, which uses the mathematics of elliptic curves to generate shared secret keys. In X25519, the elliptic curve used is Curve25519, which is a popular and efficient curve that is designed to be secure and resistant to attacks.

The key exchange process begins with each party generating a private key, which is a random 256-bit number. The private key is then used to calculate a public key by performing a scalar multiplication of the private key with a base point on the elliptic curve. The resulting public key is a point on the curve that can be shared with the other party over an insecure channel.

Once both parties have exchanged their public keys, they can each calculate a shared secret key by performing another scalar multiplication, this time using their own private key and the other party's public key. The resulting point on the curve is converted to a 256-bit shared secret key that can be used for subsequent encryption and decryption of messages.

## ![ED25519](/assets/ed25519.png)

Fun fact: X25519 is currently being used in TLS 1.3, Signal, Wireguard, Tor and others!

## Key-splitting - S4

Shamir's Secret Sharing is a cryptographic algorithm that allows a secret to be divided into multiple shares, each of which can be distributed to different individuals or stored in different locations. The secret can only be reconstructed if a sufficient number of shares are combined together, while individual shares reveal no information about the secret. This technique is often used to distribute encryption keys or to protect sensitive information against loss or theft.

The algorithm was developed by Adi Shamir in 1979 and is based on the mathematics of polynomial interpolation. To use the algorithm, a secret is first chosen, along with a threshold number of shares that must be combined to reconstruct the secret. A random polynomial of degree n-1 is then generated, where n is the total number of shares, and the coefficients of the polynomial are chosen randomly.

Each share is then generated by evaluating the polynomial at a different point. For example, if there are five shares, the polynomial might be evaluated at x=1, 2, 3, 4, and 5, to generate five different shares. Each share consists of a pair of values (x,y), where x is the point at which the polynomial was evaluated and y is the result.

To reconstruct the secret, a minimum number of shares equal to the threshold must be combined together. This is done by using polynomial interpolation to reconstruct the original polynomial from the shares and then evaluating the polynomial at x=0 to obtain the secret.

The strength of Shamir's Secret Sharing lies in the fact that individual shares reveal no information about the secret, as long as the number of shares distributed is greater than the threshold. This means that even if an attacker gains access to some of the shares, they cannot learn anything about the secret unless they obtain enough shares to reach the threshold.

---

## References

[RFC 8439 - ChaCha20 and Poly1305 for IETF Protocols](https://www.rfc-editor.org/rfc/rfc8439)

[ChaCha20-Poly1305 - Wikipedia](https://en.wikipedia.org/wiki/ChaCha20-Poly1305)

[Ed2551 - Crypto++](https://www.cryptopp.com/wiki/Ed25519)

[Ed25519: high-speed high-security signatures - cr.yp.to](https://ed25519.cr.yp.to/)

[Secret Sharing](https://en.wikipedia.org/wiki/Secret_sharing)
