import { Tag } from '@/components/Tag'

export const description =
  'Mange your secrets and environment variables with the Phase CLI'

<Tag variant="small">CLI</Tag>

# Commands and usage

```
Œª phase
Securely manage and sync environment variables with Phase.

‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢†‚†î‚†ã‚£≥‚£ñ‚†ö‚£≤‚¢ñ‚†ô‚†≥‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚°¥‚†â‚¢Ä‚°º‚†É‚¢ò‚£û‚†Å‚†ô‚°Ü‚†Ä‚†ò‚°Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚°ú‚†Å‚¢†‚†û‚†Ä‚¢†‚†û‚†∏‚°Ü‚†Ä‚†π‚°Ñ‚†Ä‚†π‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢Ä‚†û‚†Ä‚¢†‚†è‚†Ä‚£†‚†è‚†Ä‚†Ä‚¢≥‚†Ä‚†Ä‚¢≥‚†Ä‚†Ä‚¢ß‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚¢†‚†é‚†Ä‚£†‚†è‚†Ä‚£∞‚†É‚†Ä‚†Ä‚†Ä‚†à‚£á‚†Ä‚†ò‚°á‚†Ä‚†ò‚°Ü‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚¢†‚†è‚†Ä‚£∞‚†á‚†Ä‚£∞‚†É‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∫‚°Ä‚†Ä‚¢π‚†Ä‚†Ä‚¢Ω‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚¢†‚†è‚†Ä‚£∞‚†É‚†Ä‚£∞‚†É‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£á‚†Ä‚†à‚£á‚†Ä‚†ò‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚¢†‚†è‚†Ä‚¢∞‚†É‚†Ä‚£∞‚†É‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢∏‚°Ä‚†Ä‚¢π‚°Ä‚†Ä‚¢π‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚¢†‚†è‚†Ä‚¢∞‚†É‚†Ä‚£∞‚†É‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£á‚†Ä‚†à‚£á‚†Ä‚†à‚°á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†õ‚†í‚†ö‚†õ‚†í‚†ì‚†ö‚†í‚†í‚†ì‚†í‚†ì‚†ö‚†í‚†ì‚†ö‚†í‚†ì‚¢ª‚°í‚†í‚¢ª‚°í‚†í‚¢ª‚°í‚†í‚†í‚†í‚†í‚†í‚†í‚†í‚†í‚†í‚£≤‚†í‚†í‚£≤‚†í‚†í‚°≤‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢ß‚†Ä‚†Ä‚¢ß‚†Ä‚†à‚£á‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚¢†‚†á‚†Ä‚£∞‚†É‚†Ä‚£∞‚†É‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ò‚°Ü‚†Ä‚†ò‚°Ü‚†Ä‚†∏‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚£†‚†á‚†Ä‚£∞‚†É‚†Ä‚£¥‚†É‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†π‚°Ñ‚†Ä‚†π‚°Ñ‚†Ä‚†π‚°Ñ‚†Ä‚†Ä‚†Ä‚†Ä‚°¥‚†É‚¢Ä‚°º‚†Å‚¢Ä‚°º‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†ô‚£Ü‚†Ä‚†ô‚£Ü‚†Ä‚†π‚£Ñ‚†Ä‚£†‚†é‚†Å‚£†‚†û‚†Ä‚°§‚†è‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†à‚†≥‚¢§‚£à‚£≥‚£§‚£º‚£π‚¢•‚£∞‚£ã‚°•‚°¥‚†ä‚†Å‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä

Options:
  -h, --help   show this help message and exit
  --version, -v
               show program's version number and exit

Commands:

    auth             üíª Authenticate with Phase
    init             üîó Link your project with your Phase app
    run              üöÄ Run and inject secrets to your app
    secrets          üóùÔ∏è Manage your secrets
    secrets list     üìá List all the secrets
    secrets get      üîç Get a specific secret by key
    secrets create   üí≥ Create a new secret
    secrets update   üìù Update an existing secret
    secrets delete   üóëÔ∏è Delete a secret
    secrets import   üì© Import secrets from a .env file
    secrets export   ü•° Export secrets in a dotenv format
    users            üë• Manage users and accounts
    whoami           üôã See details of the current user
    logout           üèÉ Logout from phase-cli
    keyring          üîê Display information about the Phase keyring
    console          üñ•Ô∏è Open the Phase Console in your browser
    update           üÜô Update the Phase CLI to the latest version
```

## Available commands {{ className: 'lead' }}

To use Phase CLI, simply run:

```fish
> phase [command] [sub-command] [options]
```

To view all available commands and their descriptions, run:

```fish
> phase --help
```

```fish
> phase secrets -h
```

---

## üíª `auth`

Authenticate with Phase using the CLI on your own machine. The `phase auth` command lets you log in to either Phase Cloud or a Self-hosted instance of Phase. You have two authentication methods:

1. **Webauth (Default)**: This automated method opens the Phase Console in your default browser for authentication. You'll simply enter your `sudo` password to authenticate the CLI seamlessly. For Self-Hosted instances, you'll be prompted to enter the host URL.

Note that during this process, an ephemeral X25519 keypair is generated and a crypto sealed box is used for enhanced security and no tokens or private keys are exchanged in plain text.

2. **Token**: A manual method where you create a Personal Access Token in the Phase Console and supply it to the CLI. For Self-Hosted instances, you'll need to provide the host URL along with your email and Phase Personal Access Token.

<Note>
  If you're running the CLI in a headless environment (e.g., CI/CD, Docker
  container, bash script), pass the `PHASE_HOST` and `PHASE_SERVICE_TOKEN`
  environment variables. For more details, see [Environment
  Variables](commands#environment-variables).
</Note>

```bash
> phase auth
? Choose your Phase instance type: (Use arrow keys)
 ¬ª ‚òÅÔ∏è Phase Cloud
   üõ†Ô∏è Self Hosted
```

- `mode`: Choose the mode of authentication (`token`, `webauth`). Default: `webauth`

For `token` mode, provide the following:

- Host URL - _Only for Self-hosted instances_
- Email
- Phase Personal Access Token

Obtain a Phase Personal Access Token from [Phase Console](https://console.phase.dev) -> Personal Access Tokens -> Create User Token.

Example:

```bash
¬ª phase auth
? Choose your Phase instance type: ‚òÅÔ∏è Phase Cloud
Please authenticate via the Phase Console: https://console.phase.dev/webauth/OTM3MC00ZWViYmI1MGVlMTU3ZTliOWZk...
```

This opens the Phase Console in a new tab. Enter your `sudo` password when prompted. The CLI securely receives your credentials via encrypted POST requests to finalize authentication. If you are already authenticated, it will display your email address and provide instructions for switching accounts.

Once complete, you should see a success screen. Return to your terminal to find:

```bash
¬ª phase auth
? Choose your Phase instance type: ‚òÅÔ∏è Phase Cloud
Please authenticate via the Phase Console: https://console.phase.dev/webauth/OTM3MC00ZWViYmI1MGVlMTU3ZTliOWZkZT...

‚úÖ Authentication successful. Credentials saved in the Phase keyring.
üéâ Welcome to Phase CLI!

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
üôã Need help?: https://slack.phase.dev
üíª Bug reports / feature requests: https://github.com/phasehq/cli
```

---

## üîó `init`

Link your local application or project to your Phase app. The `phase init` command creates a `.phase.json` file in the root of your projects which holds important contexts for the `phase` cli, so you don't have to pass arguments repetitively. This file does not contain any sensitive information and can be check into your git repo.

Usage:

```fish
> phase init
```

During the process, you'll be asked to select an app previously created in the Phase Console:

```fish
> phase init
? Select an App: [use arrow keys]

   ferrari
 ¬ª keyspace
   inception
   Exit
```

Choosing an app will create a `.phase.json` configuration file in your project's working directory:

```fish
> phase init
? Select an App: keyspace
‚úÖ Initialization completed successfully.

> cat .phase.json
{
  "version": "1",
  "phaseApp": "keyspace",
  "appId": "511f26b7-5b56-47f3-920e-a4edb9cdbf3c",
  "defaultEnv": "Development"
}
```

**Tip**: Modify the `defaultEnv` in `.phase.json` to set the default environment context for the Phase CLI. For example, `"defaultEnv": "production"`.

---

## üöÄ `run`

Run and inject secrets into your app with the ability to override default settings.

Usage:

```fish
> phase run [--env ENVIRONMENT] [--app APP_NAME] [--tags TAGS] [command_to_run]
```

- `command_to_run`: The command you wish to run, such as `yarn dev`. You can also chain multiple command together by wrapping them in double quotes, example: `phase run "printenv | grep secret"`
- `--env`: (Optional) Specify the environment (e.g., `dev`, `staging`, `production`). Supports partial string matching eg. `prod` for `production`
- `--app`: (Optional) Name of your Phase application. Use this if you don't have a `.phase.json` file in your project directory or want to override it.
- `--tags`: (Optional) Comma-separated list of tags to filter secrets.

The `run` command executes your specified shell command, setting environment variables to the secrets fetched from Phase. It resolves cross-environment and local references in secrets.

Examples:

```fish
> phase run yarn dev
```

```fish
> phase run --env dev "printenv | grep DJANGO_SECRET_KEY"
DJANGO_SECRET_KEY=7842cc89c5a703acdf4797e0f063e1851734cea0677ad9382158cfcee26195df
```

Injecting [Referenced secrets](/cli/commands#secret-referencing):

```fish
> phase secrets get PROD_AWS_KEY --env dev
KEY üóùÔ∏è                | VALUE ‚ú®
----------------------------------------------------------------------------------------
PROD_AWS_KEY         | ‚õìÔ∏è` ${prod.AWS_ACCESS_KEY_ID}

> phase run --env dev "printenv | grep PROD_AWS_KEY"
PROD_AWS_KEY=AKIA2OGYBAH63UA3VNFG

# In the event a user doesn't have access to prod / production environment
> phase run --env dev "printenv | grep PROD_AWS_KEY"
‚ö†Ô∏è Warning: The environment 'prod' for key 'PROD_AWS_KEY' either does not exist or you do not have access to it. Reference AWS_ACCESS_KEY_ID not found. Ignoring...
PROD_AWS_KEY=
```

Chaining multiple commands:

```fish
> phase run --env prod "python manage.py migrate && python manage.py runserver backend:8000"
```

**Additional Notes**:

- The `phase run` only exposes secrets to your applications runtime and not to the rest of your system for security reasons.
- When specifying tags with `--tags`, only secrets matching these tags will be injected into the environment.
- Cross-environment and local references in secrets are automatically resolved and injected. Warnings are issued if any references cannot be resolved.
- Errors during the command execution or secret fetching process will result in an appropriate error message and termination of the process.

---

To update the documentation for the `secrets` command based on the CLI source code, I'll incorporate additional options and details that are currently not covered in the documentation. Here's how the revised version would look:

## üóùÔ∏è `secrets`

Manage your secrets with various sub-commands.

### üìá a. `list`

List all the secrets in a specified environment, with options to show uncensored secrets, filter by app, and filter by tags.

Usage:

```fish
> phase secrets list [--show] [--env ENVIRONMENT] [--app APP_NAME] [--tags TAGS]
```

- `--show`: Display secrets uncensored.
- `--env`: (Optional) Specify the environment.
- `--app`: (Optional) Name of your Phase application. Use this to override the `.phase.json` file or when it's not present in your project directory.
- `--tags`: (Optional) Comma-separated list of tags to filter secrets.

Example:

![create an app](/assets/images/cli/phase-secrets-list.png)

**Indicators**:

- `üîó`: Indicates a reference to another secret within the same environment.
- `‚õìÔ∏è`: Indicates a cross-environment reference to a secret in another environment.
- `üè∑Ô∏è`: Indicates a tag associated with a secret.
- `üí¨`: Indicates a comment associated with a secret.
- `üîè`: Indicates a personal secret, visible only to the user who set it.

### üîç b. `get`

Retrieve detailed information about a specific secret, with the ability to specify the application and filter by tags.

Usage:

```fish
> phase secrets get KEY [--env ENVIRONMENT] [--app APP_NAME] [--tags TAGS]
```

- `KEY`: The key associated with the secret you want to fetch.
- `--env`: (Optional) Specify the environment in which to search for the secret.
- `--app`: (Optional) Name of your Phase application. Use this option to override the `.phase.json` file in your project directory or when it's not present.
- `--tags`: (Optional) Comma-separated list of tags to filter secrets.

Example:

```fish
> phase secrets get DJANGO_DEBUG
{
    "key": "DJANGO_DEBUG",
    "value": "True",
    "overridden": true,
    "tags": [
        "local-development"
    ],
    "comment": "This is only for local development. NOT to be used in production."
}
```

**Notes**:

- The `get` command provides a JSON-formatted output including key details such as the secret value, whether it's overridden, tags associated with it, and any comments.
- Using the `--tags` option allows you to filter the secret based on specific tags.

### üí≥ c. `create`

Create a new secret with options to input the value manually, read from stdin, or generate a random value of specified type and length.

Usage:

```fish
> phase secrets create [KEY] [--env ENVIRONMENT] [--app APP_NAME] [--random TYPE] [--length LENGTH]
```

- `KEY`: (Optional) The key for the new secret. It will be converted to uppercase. If the value is not provided as an argument, it will be read from stdin.
- `--env`: (Optional) Specify the environment where the secret will be created.
- `--app`: (Optional) Name of your Phase application. Use this to override the `.phase.json` file or when it's not present in your project directory.
- `--random`: (Optional) Specify the type of random value to generate. Available types are `hex`, `alphanumeric`, `base64`, `base64url`, `key128`, `key256`. Example: `--random hex`.
- `--length`: (Optional) Specify the length of the random value. Applicable for types other than `key128` and `key256`. Default length is 32. Example: `--length 16`.

Examples:

```fish
# Create a secret by reading the value from stdin
> cat ~/.ssh/id_rsa | phase secrets create SSH_PRIVATE_KEY

# Create a secret with a randomly generated hexadecimal value of 32 characters
> phase secrets create RAND --random hex --length 32
```

**Notes**:

- When using `--random`, the command will automatically generate a secret value based on the specified type and length.
- The `--length` option is applicable for types other than `key128` and `key256`, which have predefined lengths.

#### d. `update`

Update an existing secret.

Usage:

```fish
> phase secrets update KEY [--env ENVIRONMENT]
```

- `KEY`: The key associated with the secret to update.
- `--env`: (Optional) Specify the environment.

Example:

```fish
> phase secrets update DEBUG
Please enter the new value for DEBUG (hidden): # Set to False
Successfully updated the secret.
KEY üóùÔ∏è                    | VALUE ‚ú®
---------------------------------------------------------------------------------------------------
DEBUG                     | *****

ü•Ω To uncover the secrets, use: phase secrets list --show

# Pipe a value via stdin:
> cat ~/.ssh/id_ed25519 | phase secrets update SSH_PRIVATE_KEY
KEY üóùÔ∏è                           | VALUE ‚ú®
---------------------------------------------------------------------------------------------------
SSH_PRIVATE_KEY                  | ---****************************************

ü•Ω To uncover the secrets, use: phase secrets list --show
```

#### e. `delete`

Delete a secret.

Usage:

```fish
> phase secrets delete KEYS... [--env ENVIRONMENT]
```

- `KEYS`: One or more keys to be deleted.
- `--env`: (Optional) Specify the environment.

Example:

```fish
> phase secrets delete DEBUG
Successfully deleted the secrets.
KEY üóùÔ∏è                    | VALUE ‚ú®
---------------------------------------------------------------------------------------------------

ü•Ω To uncover the secrets, use: phase secrets list --show
```

#### f. `import`

Import secrets from a .env file.

Usage:

```fish
> phase secrets import ENV_FILE [--env ENVIRONMENT]
```

- `ENV_FILE`: The `.env` file to import from.
- `--env`: (Optional) Specify the environment.

Example:

```fish
> cat .env
AWS_ACCESS_KEY_ID="AKIA2OGYBAH63UA3VNFG"
AWS_SECRET_ACCESS_KEY="V5yWXDe82Gohf9DYBhpatYZ74a5fiKfJVx8rx6W1"

> phase secrets import .env --env prod
Successfully imported and encrypted 2 secrets.
To view them please run: phase secrets list --env prod

> phase secrets list --env prod
KEY üóùÔ∏è                    | VALUE ‚ú®
---------------------------------------------------------------------------------------------------
AWS_ACCESS_KEY_ID        | AKI**************NFG
AWS_SECRET_ACCESS_KEY    | V5y**********************************6W1

ü•Ω To uncover the secrets, use: phase secrets list --show

> rm .env
```

#### g. `export`

Export secrets in a dotenv format.

Usage:

```fish
> phase secrets export [KEYS...] [--env ENVIRONMENT]
```

- `KEYS`: (Optional) List of keys separated by space.
- `--env`: (Optional) Specify the environment.

```fish
# Export all the secrets in the production environment
> phase secrets export --env prod
AWS_ACCESS_KEY_ID="AKIA2OGYBAH63UA3VNFG"
AWS_SECRET_ACCESS_KEY="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"

# Export only the AWS_SECRET_ACCESS_KEY in the production environment
> phase secrets export AWS_SECRET_ACCESS_KEY --env prod
AWS_SECRET_ACCESS_KEY="V5yWXDe82Gohf9DYBhpatYZ74a5fiKfJVx8rx6W1"

# Export all secrets in the dev (default) environment and pipe them to a .env file
> phase secrets export > .env.example
> head .env.example
AWS_SECRET_ACCESS_KEY="V5yWXDe82Gohf9DYBhpatYZ74a5fiKfJVx8rx6W1"
DB_NAME="XP1_LM"
DB_UER="j_mclaren"
DJANGO_SECRET_KEY="38d325eec2020f01556d50dfa12a6d9a31a27e90fa9e3adc22c539ec7d361d73"
DJANGO_DEBUG="True"
DB_PASSWORD="601602017dde26ce94f46748e0fc342b046d4e36f623957b9be94ca4d616076c"
DB_HOST="mc-laren-prod-db.c9ufzjtplsaq.us-west-1.rds.amazonaws.com"
DB_PORT="5432"
DATABASE_URL="postgresql://j_mclaren:601602017dde26ce94f46748e0fc342b046d4e36f623957b9be94ca4d616076c@mc-laren-prod-db.c9ufzjtplsaq.us-west-1.rds.amazonaws.com:5432/XP1_LM"

# In the event a user doesn't have access to prod / production environment
> phase secrets export PROD_AWS_KEY PROD_AWS_SECRET_ACCESS_KEY --env prod
AWS_ACCESS_KEY_ID="AKIA2OGYBAH63UA3VNFGds"
# Warning: The environment 'prod' for key 'PROD_AWS_SECRET_ACCESS_KEY' either does not exist or you do not have access to it.
PROD_AWS_SECRET_ACCESS_KEY=""

```

## Secret referencing

Phase Console and CLI also support dotenv styled secret referencing.

You can set a value of a secret to a value of another by simply pointing to it via the following syntax.

| Environment  | Syntax                   |
| ------------ | ------------------------ |
| **üîó Local** | `${<key>}`               |
| **‚õìÔ∏è Cross** | `${<environment>.<key>}` |

Values prefixed with a `üîó` indicate a local secret being referenced, whereas values prefixed with `‚õìÔ∏è` indicate cross environment secret value being referenced ie. development, staging, prod.

**Examples**:

Local environment secret referencing:

```fish
> phase secrets list --env prod --show
KEY üóùÔ∏è                   | VALUE ‚ú®
-------------------------------------------------------------------------------------------------
DJANGO_SECRET_KEY        | 7842cc89c5a703acdf4797e0f063e1851734cea0677ad9382158cfcee26195df
DJANGO_DEBUG             | True
DB_NAME                  | XP1_LM
DB_USER                  | j_mclaren
DB_PASSWORD              | 6c37810ec6e74ec3228416d2844564fceb99ebd94b29f4334c244db011630b0e
DB_HOST                  | mc-laren-prod-db.c9ufzjtplsaq.us-west-1.rds.amazonaws.com
DB_PORT                  | 5432
DATABASE_URL             | üîó postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}

> phase run "printenv | grep DATABASE_URL"
DATABASE_URL=postgresql://j_mclaren:6c37810ec6e74ec3228416d2844564fceb99ebd94b29f4334c244db011630b0e@mc-laren-prod-db.c9ufzjtplsaq.us-west-1.rds.amazonaws.com:5432/XP1_LM
```

The database connection string `postgresql://` is referencing `DB_USER`, `DB_PASSWORD`, `DB_HOST`, `DB_PORT` and `DB_NAME` from the same environment (dev/development)

Cross environment secret referencing:

```fish
> phase secrets list --env prod --show
KEY üóùÔ∏è                    | VALUE ‚ú®
----------------------------------------------------------------------------
DATABASE_URL              | ‚õìÔ∏è postgresql://${dev.DB_USER}:${dev.DB_PASSWORD}@${dev.DB_HOST}:${dev.DB_PORT}/${dev.DB_NAME}

> phase run --env prod "printenv | grep DATABASE_URL"
DATABASE_URL=postgresql://j_mclaren:6c37810ec6e74ec3228416d2844564fceb99ebd94b29f4334c244db011630b0e@mc-laren-prod-db.c9ufzjtplsaq.us-west-1.rds.amazonaws.com:5432/XP1_LM
```

**Note**: This is assuming an environment named dev/development exists and has a secrets with the keys `AWS_ACCESS_KEY_ID` and `AWS_SECRET_ACCESS_KEY`.

---

## `logout`

Logout from the Phase CLI.

Usage:

```fish
> phase logout [--purge]
```

- `--purge`: Purge all local data.

---

## `console`

Open the Phase Console in your web browser.

Usage:

```fish
> phase console
```

---

## `update`

Update the Phase CLI to the latest version. This subcommand will be only shown on linux systems when the cli is installed via the installation script.

Usage:

```fish
> phase update
```

---

## `keyring`

Display information about the Phase keyring. Phase keyring holds sensitive credentials such as user tokens.

Usage:

```fish
> phase keyring
```

---

## Environment variables

### `PHASE_DEBUG`

Type: Boolean

Description: Set to true to get full tracebacks for error messages

Example:

```fish
> PHASE_DEBUG=True phase secrets list
Exception: üóø Network error: Please check your internet connection. Detail: HTTPConnectionPool(host='localhost', port=443): Max retries exceeded with url: /secrets/tokens/ (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7f7c2041d7d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
```

### `PHASE_HOST`

Type: String

Description: A full URL to the REST API of the Phase Service

Example:

```fish
> export PHASE_HOST=https://phase.internal.company.domain.com

> phase secrets export
...
```

### `PHASE_SERVICE_TOKEN`

Type: String

Description: A way to authenticate with the Phase Service via tokens, useful for running the cli in an headless environment like CI/CD, Docker containers etc.

Example:

```fish
> export PHASE_SERVICE_TOKEN=pss_service...

> phase secrets export
...
```

### `PHASE_VERIFY_SSL`

Type: Boolean

Description: A way to temporarily disable TLS certificate verification checks

Note: Disable TLS certificate verification is dangerous and can expose you to risks of [MITM](https://en.wikipedia.org/wiki/Man-in-the-middle_attack) attacks.

Example:

```fish
> export PHASE_VERIFY_SSL=True

> phase secrets export
...
```
