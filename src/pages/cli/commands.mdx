import { Tag } from '@/components/Tag'

export const description =
  'Mange your secrets and environment variables with the Phase CLI'

<Tag variant="small">CLI</Tag>

# CLI

The Phase CLI works together with the [Phase Console](https://github.com/phasehq/console) to securely sync your secrets and environment variables with **End-to-End Encryption**. It is designed to pull secrets, decrypt them and inject secrets directly into your application or framework during runtime. You can use it to create, retrieve, update and delete your application secrets for different environments such as `development`, `staging`, `production` or something custom.

```
¬ª phase

         :@tX88%%:
        ;X;%;@%8X@;
      ;Xt%;S8:;;t%S
      ;SXStS@.;t8@:;.
    ;@:t;S8  ;@.%.;8:
    :X:S%88    S.88t:.
  :X:%%88     :S:t.t8t
.@8X888@88888888X8.%8X8888888X8.S88:
                ;t;X8;      ;XS:%X;
                :@:8@X.     XXS%S8
                 8XX:@8S  .X%88X;
                  ..@:X88:8Xt8:
                     ;%88@S8:

options:
  -h, --help            show this help message and exit
  --version, -v         show program's version number and exit

Commands:
  {auth,init,run,secrets,logout,console,update,keyring}
    auth                üíª Authenticate with Phase
    init                üîó Link your project to your Phase app
    run                 üöÄ Run and inject secrets to your app
    secrets             üóùÔ∏è Manage your secrets
    logout              üèÉ Logout from phase-cli
    console             üñ•Ô∏è Open the Phase Console in your browser
    update              üîÑ Update the Phase CLI to the latest version
    keyring             üîê Display information about the Phase keyring
```

## Available commands {{ className: 'lead' }}

## auth

```
¬ª phase auth
? Choose your Phase instance type: (Use arrow keys)
 ¬ª ‚òÅÔ∏è Phase Cloud
   üõ†Ô∏è Self Hosted
```

Authenticate with Phase

Description:

Usage:

## init

Link your project to your Phase app

```json
{
  "version": "1",
  "phaseApp": "ferrari",
  "appId": "df7086eb-9080-4329-9991-25c386a6d59b",
  "defaultEnv": "Development"
}
```

Description:

Usage:

## run

Run and inject secrets to your app

Description:

Usage:

## secrets

Manage your secrets

Description:

Usage:

## logout

Logout from phase-cli

Description:

Usage:

## console

Open the Phase Console in your browser

Description:

Usage:

## update

Update the Phase CLI to the latest version

Description:

Usage:

## keyring

Display information about the Phase keyring

Description:

Usage:

## Export secrets back to .env file

```
phase secrets export
```

This will create an `.env` file and export all secrets as key value pairs in the given environment

## Switching between environments via the `--env` flag

Phase Console by default creates three environment for each application. ie. `development`, `staging` and `production`. You can switch in between them via the `--env` followed by the environment name or prefix. Keep in mind, **by default the Phase CLI will use the `development` environment** even if the `--env` flag is not passed.

Example 1:

```bash
phase secrets create HOST --env staging
```

Example 2:
It's also possible to provide an environment prefix for brevity

```bash
phase secrets list --env stag # Even though environment name is staging
```

Example 3:

```bash
phase run --env prod "python manage.py migrate && python manage.py runserver backend:8000"
```

## Secret referencing

Phase Console and CLI also support dotenv styled secret referencing.

You can refer a value of a secret residing in your current environment (eg. development) or across environments. Values prefixed with a `üîó` indicate local secrets value being referenced and values prefixed with `‚õìÔ∏è` indicate cross environment secret value being referenced.

The syntax is as follows:

Local: `${<key>}`

Cross environment: `${<environment>.<key>}`

**Examples**:

Local environment secret referencing:

```bash
phase secrets list --env prod --show
KEY üóùÔ∏è                   | VALUE ‚ú®
-------------------------------------------------------------------------------------------------
DJANGO_SECRET_KEY        | 7842cc89c5a703acdf4797e0f063e1851734cea0677ad9382158cfcee26195df
DJANGO_DEBUG             | True
DB_NAME                  | XP1_LM
DB_USER                  | j_mclaren
DB_PASSWORD              | 6c37810ec6e74ec3228416d2844564fceb99ebd94b29f4334c244db011630b0e
DB_HOST                  | mc-laren-prod-db.c9ufzjtplsaq.us-west-1.rds.amazonaws.com
DB_PORT                  | 5432
DATABASE_URL             | üîó postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}
```

The database connection string `postgresql://` is referencing `DB_USER`, `DB_PASSWORD`, `DB_HOST`, `DB_PORT` and `DB_NAME` from the same environment (dev/development)

Cross environment secret referencing:

```bash
phase secrets list --env prod --show
KEY üóùÔ∏è                   | VALUE ‚ú®
-------------------------------------------------------------------------------------------------
AWS_ACCESS_KEY_ID        | ‚õìÔ∏è ${dev.AWS_ACCESS_KEY_ID}
AWS_SECRET_ACCESS_KEY    | ‚õìÔ∏è ${dev.AWS_SECRET_ACCESS_KEY}
```

Note: This is assuming an environment (dev/development) has a secret with the key `AWS_ACCESS_KEY_ID` and `AWS_SECRET_ACCESS_KEY`.

## General Usage

To use Phase CLI, simply run:

```
phase-cli [command] [sub-command] [options]
```

To view all available commands and their descriptions, run:

```
phase-cli --help
```

## Available Commands

### 1. `auth`

Authenticate with Phase.

Usage:

```
phase-cli auth
```

### 2. `init`

Link your project to your Phase app.

Usage:

```
phase-cli init
```

### 3. `run`

Run and inject secrets into your app.

Usage:

```
phase-cli run [command_to_run] [--env ENVIRONMENT]
```

- `command_to_run`: The command you wish to run. For example: `yarn dev`.
- `--env`: (Optional) Specify the environment (e.g., `dev`, `staging`, `production`).

### 4. `secrets`

Manage your secrets. This command has several sub-commands.

#### a. `list`

List all the secrets.

Usage:

```
phase-cli secrets list [--show] [--env ENVIRONMENT]
```

- `--show`: Display secrets uncensored.
- `--env`: (Optional) Specify the environment.

#### b. `get`

Retrieve a specific secret by key.

Usage:

```
phase-cli secrets get KEY [--env ENVIRONMENT]
```

- `KEY`: The key associated with the secret to fetch.
- `--env`: (Optional) Specify the environment.

#### c. `create`

Create a new secret.

Usage:

```
phase-cli secrets create [KEY] [--env ENVIRONMENT]
```

- `KEY`: (Optional) The key for the secret to be created.
- `--env`: (Optional) Specify the environment.

#### d. `update`

Update an existing secret.

Usage:

```
phase-cli secrets update KEY [--env ENVIRONMENT]
```

- `KEY`: The key associated with the secret to update.
- `--env`: (Optional) Specify the environment.

#### e. `delete`

Delete a secret.

Usage:

```
phase-cli secrets delete KEYS... [--env ENVIRONMENT]
```

- `KEYS`: One or more keys to be deleted.
- `--env`: (Optional) Specify the environment.

#### f. `import`

Import secrets from a .env file.

Usage:

```
phase-cli secrets import ENV_FILE [--env ENVIRONMENT]
```

- `ENV_FILE`: The `.env` file to import from.
- `--env`: (Optional) Specify the environment.

#### g. `export`

Export secrets in a dotenv format.

Usage:

```
phase-cli secrets export [KEYS...] [--env ENVIRONMENT]
```

- `KEYS`: (Optional) List of keys separated by space.
- `--env`: (Optional) Specify the environment.

### 5. `logout`

Logout from the Phase CLI.

Usage:

```
phase-cli logout [--purge]
```

- `--purge`: Purge all local data.

### 6. `console`

Open the Phase Console in your web browser.

Usage:

```
phase-cli console
```

### 7. `update` (Linux Only)

Update the Phase CLI to the latest version.

Usage:

```
phase-cli update
```

### 8. `keyring`

Display information about the Phase keyring.

Usage:

```
phase-cli keyring
```

---

This provides an overview of the commands and their associated options. To get more detailed explanations, always use the `--help` option with any command or sub-command.

Note: You might want to add any prerequisites, installation steps, or additional details to make this documentation more comprehensive for the end users.
