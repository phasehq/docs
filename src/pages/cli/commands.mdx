import { Tag } from '@/components/Tag'

export const description =
  'Mange your secrets and environment variables with the Phase CLI'

<Tag variant="small">CLI</Tag>

# CLI

The Phase CLI works together with the [Phase Console](https://github.com/phasehq/console) to securely sync your secrets and environment variables with **End-to-End Encryption**. It is designed to pull secrets, decrypt them and inject secrets directly into your application or framework during runtime. You can use it to create, retrieve, update and delete your application secrets for different environments such as `development`, `staging`, `production` or something custom.

```
> phase

Securely manage and sync environment variables with Phase.

⠀⠀⠀⠀⠀⠀⠀⠀⠀⢠⠔⠋⣳⣖⠚⣲⢖⠙⠳⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⡴⠉⢀⡼⠃⢘⣞⠁⠙⡆⠀⠘⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⢀⡜⠁⢠⠞⠀⢠⠞⠸⡆⠀⠹⡄⠀⠹⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⢀⠞⠀⢠⠏⠀⣠⠏⠀⠀⢳⠀⠀⢳⠀⠀⢧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⢠⠎⠀⣠⠏⠀⣰⠃⠀⠀⠀⠈⣇⠀⠘⡇⠀⠘⡆⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⢠⠏⠀⣰⠇⠀⣰⠃⠀⠀⠀⠀⠀⢺⡀⠀⢹⠀⠀⢽⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⢠⠏⠀⣰⠃⠀⣰⠃⠀⠀⠀⠀⠀⠀⠀⣇⠀⠈⣇⠀⠘⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⢠⠏⠀⢰⠃⠀⣰⠃⠀⠀⠀⠀⠀⠀⠀⠀⢸⡀⠀⢹⡀⠀⢹⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⢠⠏⠀⢰⠃⠀⣰⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣇⠀⠈⣇⠀⠈⡇⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠛⠒⠚⠛⠒⠓⠚⠒⠒⠓⠒⠓⠚⠒⠓⠚⠒⠓⢻⡒⠒⢻⡒⠒⢻⡒⠒⠒⠒⠒⠒⠒⠒⠒⠒⣲⠒⠒⣲⠒⠒⡲⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢧⠀⠀⢧⠀⠈⣇⠀⠀⠀⠀⠀⠀⠀⠀⢠⠇⠀⣰⠃⠀⣰⠃⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⡆⠀⠘⡆⠀⠸⡄⠀⠀⠀⠀⠀⠀⣠⠇⠀⣰⠃⠀⣴⠃⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠹⡄⠀⠹⡄⠀⠹⡄⠀⠀⠀⠀⡴⠃⢀⡼⠁⢀⡼⠁⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⣆⠀⠙⣆⠀⠹⣄⠀⣠⠎⠁⣠⠞⠀⡤⠏⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠳⢤⣈⣳⣤⣼⣹⢥⣰⣋⡥⡴⠊⠁⠀⠀⠀⠀⠀⠀⠀⠀⠀

options:
  -h, --help            show this help message and exit
  --version, -v         show program's version number and exit

Commands:
  {auth,init,run,secrets,logout,console,update,keyring}
    auth                💻 Authenticate with Phase
    init                🔗 Link your project to your Phase app
    run                 🚀 Run and inject secrets to your app
    secrets             🗝️ Manage your secrets
    logout              🏃 Logout from phase-cli
    console             🖥️ Open the Phase Console in your browser
    update              🔄 Update the Phase CLI to the latest version
    keyring             🔐 Display information about the Phase keyring
```

## Available commands {{ className: 'lead' }}

To use Phase CLI, simply run:

```fish
> phase [command] [sub-command] [options]
```

To view all available commands and their descriptions, run:

```fish
> phase --help
```

## `auth`

Authenticate with Phase.

```
» phase auth
? Choose your Phase instance type: (Use arrow keys)
 » ☁️ Phase Cloud
   🛠️ Self Hosted
```

---

## `init`

Link your local project to your Phase app.

Usage:

```fish
phase init
```

Example:

```fish
> phase init
? Select an App: [use arrow keys]

   ferrari
 » keyspace
   inception
   Exit

> phase init
? Select an App: keyspace
✅ Initialization completed successfully.
```

This would create a Phase application config in your projects working directly:

```fish
> cat .phase.json
{
  "version": "1",
  "phaseApp": "keyspace",
  "appId": "511f26b7-5b56-47f3-920e-a4edb9cdbf3c",
  "defaultEnv": "Development"
}
```

**Tip**: You can manually set the default environment context for the Phase CLI by modifying the `defaultEnv`. Eg. `"defaultEnv": "Production"`

---

## `run`

Run and inject secrets into your app.

Usage:

```fish
> phase run [command_to_run] [--env ENVIRONMENT]
```

- `command_to_run`: The command you wish to run. For example: `yarn dev`.
- `--env`: (Optional) Specify the environment (e.g., `dev`, `staging`, `production`).

Examples:

```fish
> phase run yarn dev
```

```fish
> phase run --env dev "printenv | grep DJANGO_SECRET_KEY"
DJANGO_SECRET_KEY=7842cc89c5a703acdf4797e0f063e1851734cea0677ad9382158cfcee26195df
```

```fish
> phase run --env prod "python manage.py migrate && python manage.py runserver backend:8000"
```

---

## `secrets`

Manage your secrets. This command has several sub-commands.

#### a. `list`

List all the secrets.

Usage:

```fish
> phase secrets list [--show] [--env ENVIRONMENT]
```

- `--show`: Display secrets uncensored.
- `--env`: (Optional) Specify the environment.

Example:

```fish
phase secrets list --env prod --show
KEY 🗝️                   | VALUE ✨
-------------------------------------------------------------------------------------------------
DJANGO_SECRET_KEY        | 7842cc89c5a703acdf4797e0f063e1851734cea0677ad9382158cfcee26195df
DJANGO_DEBUG             | True
DB_NAME                  | XP1_LM
DB_USER                  | j_mclaren
DB_PASSWORD              | 6c37810ec6e74ec3228416d2844564fceb99ebd94b29f4334c244db011630b0e
DB_HOST                  | mc-laren-prod-db.c9ufzjtplsaq.us-west-1.rds.amazonaws.com
DB_PORT                  | 5432
```

#### b. `get`

Retrieve a specific secret by key.

Usage:

```fish
> phase secrets get KEY [--env ENVIRONMENT]
```

- `KEY`: The key associated with the secret to fetch.
- `--env`: (Optional) Specify the environment.

#### c. `create`

Create a new secret.

Usage:

```fish
> phase secrets create [KEY] [--env ENVIRONMENT]
```

- `KEY`: (Optional) The key for the secret to be created.
- `--env`: (Optional) Specify the environment.

#### d. `update`

Update an existing secret.

Usage:

```fish
> phase secrets update KEY [--env ENVIRONMENT]
```

- `KEY`: The key associated with the secret to update.
- `--env`: (Optional) Specify the environment.

#### e. `delete`

Delete a secret.

Usage:

```fish
> phase secrets delete KEYS... [--env ENVIRONMENT]
```

- `KEYS`: One or more keys to be deleted.
- `--env`: (Optional) Specify the environment.

#### f. `import`

Import secrets from a .env file.

Usage:

```fish
> phase secrets import ENV_FILE [--env ENVIRONMENT]
```

- `ENV_FILE`: The `.env` file to import from.
- `--env`: (Optional) Specify the environment.

#### g. `export`

Export secrets in a dotenv format.

Usage:

```fish
> phase secrets export [KEYS...] [--env ENVIRONMENT]
```

- `KEYS`: (Optional) List of keys separated by space.
- `--env`: (Optional) Specify the environment.

### Secret referencing

Phase Console and CLI also support dotenv styled secret referencing.

You can refer a value of a secret residing in your current environment (eg. development) or across environments. Values prefixed with a `🔗` indicate local secrets value being referenced and values prefixed with `⛓️` indicate cross environment secret value being referenced.

| Environment  | Syntax                   |
| ------------ | ------------------------ |
| **🔗 Local** | `${<key>}`               |
| **⛓️ Cross** | `${<environment>.<key>}` |

**Examples**:

Local environment secret referencing:

```fish
> phase secrets list --env prod --show
KEY 🗝️                   | VALUE ✨
-------------------------------------------------------------------------------------------------
DJANGO_SECRET_KEY        | 7842cc89c5a703acdf4797e0f063e1851734cea0677ad9382158cfcee26195df
DJANGO_DEBUG             | True
DB_NAME                  | XP1_LM
DB_USER                  | j_mclaren
DB_PASSWORD              | 6c37810ec6e74ec3228416d2844564fceb99ebd94b29f4334c244db011630b0e
DB_HOST                  | mc-laren-prod-db.c9ufzjtplsaq.us-west-1.rds.amazonaws.com
DB_PORT                  | 5432
DATABASE_URL             | 🔗 postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:${DB_PORT}/${DB_NAME}
```

The database connection string `postgresql://` is referencing `DB_USER`, `DB_PASSWORD`, `DB_HOST`, `DB_PORT` and `DB_NAME` from the same environment (dev/development)

Cross environment secret referencing:

```fish
> phase secrets list --env prod --show
KEY 🗝️                   | VALUE ✨
-------------------------------------------------------------------------------------------------
AWS_ACCESS_KEY_ID        | ⛓️ ${dev.AWS_ACCESS_KEY_ID}
AWS_SECRET_ACCESS_KEY    | ⛓️ ${dev.AWS_SECRET_ACCESS_KEY}
```

**Note**: This is assuming an environment named dev/development exists and has a secrets with the keys `AWS_ACCESS_KEY_ID` and `AWS_SECRET_ACCESS_KEY`.

---

## `logout`

Logout from the Phase CLI.

Usage:

```fish
> phase logout [--purge]
```

- `--purge`: Purge all local data.

---

## `console`

Open the Phase Console in your web browser.

Usage:

```fish
> phase console
```

---

## `update`

Update the Phase CLI to the latest version. This subcommand will be only shown on linux systems when the cli is installed via the installation script.

Usage:

```fish
> phase update
```

---

## `keyring`

Display information about the Phase keyring. Phase keyring holds sensitive credentials such as user tokens.

Usage:

```fish
> phase keyring
```

---

This provides an overview of the commands and their associated options. To get more detailed explanations, always use the `--help` option with any command or sub-command.

Note: You might want to add any prerequisites, installation steps, or additional details to make this documentation more comprehensive for the end users.

---

## Environment variables

`PHASE_HOST`

### Check if debug mode is enabled

`PHASE_DEBUG`

`PHASE_SERVICE_ENDPOINT`

`PHASE_SERVICE_TOKEN`

### Check if SSL verification should be skipped

`PHASE_VERIFY_SSL`
